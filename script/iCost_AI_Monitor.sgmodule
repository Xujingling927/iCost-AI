#!name=iCost AI 服务监控模块
#!desc=用于监控主流AI大模型服务商(DeepSeek, SiliconFlow, Volcano Engine、Moonshot、Google、OpenRouter)的API请求耗时、模型名称及性能，并通过通知进行分析。支持日志等级配置。

[MITM]
hostname = %APPEND% api.deepseek.com, api.siliconflow.cn, ark.cn-beijing.volces.com, openrouter.ai, api.moonshot.cn, generativelanguage.googleapis.com

[Script]
# iCost AI服务监控 - 请求脚本 (记录开始时间及模型名称)
# 日志等级参数: log_level=info (默认) 或 log_level=debug (详细调试日志)
iCost_Request_Timer = type=http-request, pattern=^https?://(api\.deepseek\.com/chat/completions|api\.siliconflow\.cn/v1/chat/completions|ark\.cn-beijing\.volces\.com/api/v3/chat/completions|openrouter\.ai/api/v1/chat/completions|api\.moonshot\.cn/v1/chat/completions|generativelanguage\.googleapis\.com/v1beta/openai/chat/completions), requires-body=true, max-size=3145728, script-path=https://raw.githubusercontent.com/Xujingling927/iCost-AI/refs/heads/main/script/iCost_request_timer.js, timeout=30, argument=log_level=info


# iCost AI服务监控 - 响应脚本 (计算耗时并发送通知)
# 日志等级参数: log_level=info (默认) 或 log_level=debug (详细调试日志)
iCost_Response_Monitor = type=http-response, pattern=^https?://(api\.deepseek\.com/chat/completions|api\.siliconflow\.cn/v1/chat/completions|ark\.cn-beijing\.volces\.com/api/v3/chat/completions|openrouter\.ai/api/v1/chat/completions|api\.moonshot\.cn/v1/chat/completions|generativelanguage\.googleapis\.com/v1beta/openai/chat/completions), requires-body=true, max-size=3145728, script-path=https://raw.githubusercontent.com/Xujingling927/iCost-AI/refs/heads/main/script/iCost_response_monitor.js, timeout=30, argument=log_level=info